---
const { pageTitle } = Astro.props;
const pathname = Astro.url.pathname;
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Solomon Neas | {pageTitle}</title>
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" id="svg-icon" />

    <link rel="stylesheet" href="/styles/global.css" />

    <script>
      let darkmode = false;
      const svgIcon = document.getElementById("svg-icon");

      function random(min, max) {
        return Math.floor(Math.random() * (max - min + 1) + min);
      }

      function applyTheme(inverted, hueRotation) {
        const isInverted = inverted === true || inverted === "true";
        const a = isInverted ? 100 : 0;
        let style = document.getElementById("theme-style");
        if (!style) {
          style = document.createElement("style");
          style.id = "theme-style";
          document.head.append(style);
        }

        style.innerText = `
 #filter { backdrop-filter:hue-rotate(${hueRotation}deg) invert(${a}%); }
 `;

        const svgContent = `<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' fill='none' /><text x='10' y='65' font-family='"IBM Plex Mono", monospace' font-weight='bold' font-size='70' fill='#e0e0e0'>&gt;_</text><style>svg{filter:hue-rotate(${hueRotation}deg) invert(${a}%25);}</style></svg>`;
        const o = `data:image/svg+xml,${encodeURIComponent(svgContent)}`;
        svgIcon.setAttribute("href", o);
        saveThemeToLocalStorage(isInverted, hueRotation);
      }

      function saveThemeToLocalStorage(inverted, hueRotation) {
        if (!localStorage) return;
        localStorage.setItem("inverted", inverted ? "true" : "false");
        localStorage.setItem("hueRotation", hueRotation);
      }

      function getThemeFromLocalStorage() {
        if (!localStorage) return;
        let inverted = localStorage.getItem("inverted");
        const hueRotation = localStorage.getItem("hueRotation");

        if (inverted === "true") {
          darkmode = true;
        }

        if (hueRotation) {
          applyTheme(inverted, hueRotation);
        }
      }

      document.addEventListener("DOMContentLoaded", () => {
        const btn = document.getElementById("color");
        btn.addEventListener("click", () => {
          darkmode = !darkmode;
          const hue = Math.floor(random(0, 360));
          applyTheme(darkmode, hue);
        });

        getThemeFromLocalStorage();

        const animationStyle = document.createElement("style");
        document.head.append(animationStyle);

        setTimeout(() => {
          animationStyle.innerText = `* {
            transition-property:filter, backdrop-filter;
            transition-duration: 1s;
          }`;
        }, 1);
      });
    </script>
  </head>
  <body>
    <div id="filter"></div>
    <div class="site-wrapper">
      <a href="#main-content" id="skip-link">Skip to content</a>
      <nav>
        <div class="title-container">
          <div class="serif site-title">Solomon Neas</div>
          <button id="color" class="button">random theme</button>
        </div>
        <div class="nav-links">
          <ul>
            <li>
              <a href="/" class={pathname === "/" ? "current-link" : ""}>Home</a>
            </li>
            <li>
              <a href="/about" class={pathname.startsWith("/about") ? "current-link" : ""}>About</a>
            </li>
            <li>
              <a href="/opportunities" class={pathname.startsWith("/opportunities") ? "current-link" : ""}>
                Opportunities
              </a>
            </li>
            <li>
              <a href="/projects" class={pathname.startsWith("/projects") ? "current-link" : ""}>Projects</a>
            </li>
            <li>
              <a href="/resources" class={pathname.startsWith("/resources") ? "current-link" : ""}>Resources</a>
            </li>
            <li>
              <a href="/blog" class={pathname.startsWith("/blog") ? "current-link" : ""}>Blog</a>
            </li>
            <li><a href="/rss.xml" target="_blank">RSS</a></li>
            <li>
              <a href="/contact" class={pathname.startsWith("/contact") ? "current-kind" : ""}>Contact</a>
            </li>
          </ul>
        </div>
      </nav>
      <main id="main-content">
        <slot />
      </main>
      <footer id="footer">
        {
          pathname.startsWith("/blog/") && (
            <div class="text-center" style="margin-bottom: 2rem;">
              <a href="/blog" class="text-lg text-blue-500 hover:underline">
                Back to Blog
              </a>
            </div>
          )
        }
        <div class="nav-links footer-links">
          <ul>
            <li>
              <a href="https://www.linkedin.com/in/solomon-neas/" target="_blank" aria-label="LinkedIn">
                <svg class="social-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                  <path
                    d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z">
                  </path>
                </svg>
              </a>
            </li>
            <li>
              <a href="https://x.com/solomonneas" target="_blank" aria-label="X (formerly Twitter)">
                <svg class="social-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                  <path
                    d="M18.901 1.153h3.68l-8.04 9.19L24 22.846h-7.406l-5.8-7.584-6.638 7.584H.474l8.6-9.83L0 1.154h7.594l5.243 6.932L18.901 1.153ZM17.61 20.644h2.039L6.486 3.24H4.298L17.61 20.644Z">
                  </path>
                </svg>
              </a>
            </li>
            <li>
              <a href="mailto:srneas@gmail.com" aria-label="Email">
                <svg class="social-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                  <path
                    d="M0 3v18h24v-18h-24zm6.623 7.929l-4.623 5.712v-9.458l4.623 3.746zm-4.141-5.929h19.035l-9.517 7.713-9.518-7.713zm5.694 7.188l3.824 3.099l3.824-3.099 5.441 6.812h-18.53l5.441-6.812zm9.201-1.259l4.623-3.746v9.458l-4.623-5.712z">
                  </path>
                </svg>
              </a>
            </li>
            <li>
              <a href="https://ko-fi.com/solomonneas" target="_blank" aria-label="Ko-fi">
                <svg class="social-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                  <path
                    d="M23.881 8.948c-.773-4.085-4.859-4.593-4.859-4.593H.723c-.604 0-.679.798-.679.798s-.082 7.324-.022 11.822c.164 2.424 2.586 2.672 2.586 2.672s8.267-.023 11.966-.049c2.438-.426 2.683-2.566 2.658-3.734 4.352.24 7.422-2.831 6.649-6.916zm-11.062 3.511c-1.246 1.453-4.011 3.976-4.011 3.976s-.121.119-.31.023c-.076-.057-.108-.09-.108-.09-.443-.441-3.368-3.049-4.034-3.954-.709-.965-1.041-2.7-.091-3.71.951-1.01 3.005-1.086 4.363.407 0 0 1.565-1.782 3.468-.963 1.904.82 1.832 3.011.723 4.311zm6.173.478c-.928.116-1.682.028-1.682.028V7.284h1.77s1.971.551 1.971 2.638c0 1.913-.985 2.667-2.059 3.015z">
                  </path>
                </svg>
              </a>
            </li>
          </ul>
        </div>
      </footer>
    </div>
  </body>
</html>
