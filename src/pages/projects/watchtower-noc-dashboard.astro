---
import ProjectLayout from "../../layouts/ProjectLayout.astro";

const frontmatter = {
  title: "Watchtower NOC Dashboard",
  status: "In Progress",
  statusType: "ongoing",
  origin: "Polk State College",
  date: "2026.01",
  techStack: ["FastAPI", "React", "TypeScript", "Redis", "WebSocket", "ReactFlow", "Zustand", "TailwindCSS", "Proxmox API", "LibreNMS API"],
};

const dataSources = [
  { name: "LibreNMS", type: "SNMP Metrics", provides: "Device status, interfaces, port traffic, CDP/LLDP neighbors", color: "#10b981" },
  { name: "Netdisco", type: "L2 Discovery", provides: "MAC tables, device inventory, switch port mappings", color: "#3b82f6" },
  { name: "Proxmox", type: "Virtualization", provides: "VM/container lists, CPU/memory, storage pools", color: "#f59e0b" },
  { name: "Speedtest CLI", type: "WAN Health", provides: "Download/upload speeds, latency, jitter", color: "#8b5cf6" },
];

const features = [
  { name: "Interactive Topology Canvas", desc: "Draggable network map with expandable clusters, device status indicators, and animated connection links", tech: "ReactFlow + Zustand + WebSocket", icon: "üó∫Ô∏è" },
  { name: "Cisco-Style Port Grid", desc: "Visual switch port layout with real-time status colors and hover tooltips", tech: "Custom React components", icon: "üîå" },
  { name: "Speedtest Widget", desc: "Scheduled WAN health tests with CSV history and external link coloring", tech: "Ookla CLI + Redis cache", icon: "üì∂" },
  { name: "Port Group Monitoring", desc: "Aggregate traffic across ports matching a pattern (e.g., all lab ports)", tech: "SNMP ifOctets aggregation", icon: "üìä" },
  { name: "Real-Time Updates", desc: "WebSocket pushes live device status, health metrics, and link changes without polling", tech: "FastAPI WebSocket + APScheduler", icon: "‚ö°" },
  { name: "CDP/LLDP Link Discovery", desc: "Automatic discovery of physical connections via CDP/LLDP, merged with static topology.yaml", tech: "LibreNMS API + Redis cache", icon: "üîó" },
  { name: "L2/L3 View Toggle", desc: "Switch between Physical (cable connections) and Logical (VLAN relationships) topology views", tech: "ReactFlow layout transforms", icon: "üîÄ" },
  { name: "Proxmox Panel", desc: "Live dashboard of VMs, containers, and storage pools for selected hypervisor nodes", tech: "Proxmox API integration", icon: "üñ•Ô∏è" },
  { name: "Port Search", desc: "Find switch ports by searching SNMP descriptions (ifAlias)", tech: "LibreNMS API query", icon: "üîç" },
  { name: "Mermaid Export", desc: "Export topology as Mermaid diagram for documentation with built-in viewer", tech: "Frontend Mermaid generator", icon: "üìù" },
  { name: "Alert System", desc: "Real-time alerts from device status changes with acknowledgment", tech: "Derived from device state", icon: "üîî" },
];

const techDecisions = [
  { decision: "WebSocket over polling", reason: "Reduces latency and server load for real-time updates" },
  { decision: "Redis caching", reason: "Fast in-memory access for frequently-read topology data" },
  { decision: "Multi-source aggregation", reason: "No single monitoring tool has complete network visibility" },
  { decision: "ReactFlow for topology", reason: "Handles complex graph layouts with built-in pan/zoom/interactions" },
  { decision: "Zustand over Redux", reason: "Simpler state management for medium complexity app" },
  { decision: "APScheduler", reason: "Reliable job scheduling with configurable intervals per data type" },
  { decision: "YAML configuration", reason: "Human-readable, easy to version control (minus secrets)" },
  { decision: "TypeScript throughout", reason: "Type safety for complex nested data models" },
];

const phases = [
  { phase: 1, name: "Core Dashboard", status: "completed", items: ["FastAPI backend", "React frontend", "Basic topology"] },
  { phase: 2, name: "Dual-View Topology", status: "completed", items: ["L2/L3 toggle", "VLAN filtering", "Cluster nodes"] },
  { phase: 3, name: "Integrations", status: "completed", items: ["LibreNMS polling", "Proxmox panel", "Netdisco data"] },
  { phase: 4, name: "Auto-Discovery", status: "completed", items: ["CDP/LLDP links", "Dynamic topology", "Collision detection"] },
  { phase: 5, name: "Monitoring Widgets", status: "completed", items: ["Speedtest", "Port groups", "Port search"] },
  { phase: 6, name: "Export & Polish", status: "completed", items: ["Mermaid export", "CSV logging", "Collapsible widgets"] },
  { phase: 7, name: "Authentication", status: "completed", items: ["JWT auth", "User sessions", "Login/logout flow"] },
  { phase: 8, name: "Settings UI", status: "completed", items: ["Config editor", "Polling controls", "Theme options"] },
  { phase: 9, name: "Remote Notifications", status: "pending", items: ["Discord webhooks", "Email alerts", "Escalation rules"] },
  { phase: 10, name: "Role-Based Access", status: "pending", items: ["User roles", "Permission levels", "Admin panel"] },
  { phase: 11, name: "Historical Data", status: "completed", items: ["InfluxDB integration", "Time-series metrics", "Historical charts"] },
];
---

<ProjectLayout frontmatter={frontmatter}>

  <!-- Overview -->
  <section>
    <p class="section-intro">
      A real-time network operations center dashboard built for Polk State College's IT department. Watchtower aggregates data from LibreNMS, Netdisco, Proxmox, and Speedtest into a unified monitoring interface with interactive topology maps, live device status, and WebSocket-driven updates. It replaces the need for expensive commercial NMS platforms by combining open-source tools into a single, purpose-built dashboard.
    </p>
  </section>

  <!-- GitHub Callout -->
  <section>
    <div class="github-callout">
      <div class="github-content">
        <div class="github-icon">
          <svg viewBox="0 0 24 24" width="32" height="32" fill="currentColor">
            <path d="M12 0C5.37 0 0 5.37 0 12c0 5.31 3.435 9.795 8.205 11.385.6.105.825-.255.825-.57 0-.285-.015-1.23-.015-2.235-3.015.555-3.795-.735-4.035-1.41-.135-.345-.72-1.41-1.23-1.695-.42-.225-1.02-.78-.015-.795.945-.015 1.62.87 1.845 1.23 1.08 1.815 2.805 1.305 3.495.99.105-.78.42-1.305.765-1.605-2.67-.3-5.46-1.335-5.46-5.925 0-1.305.465-2.385 1.23-3.225-.12-.3-.54-1.53.12-3.18 0 0 1.005-.315 3.3 1.23.96-.27 1.98-.405 3-.405s2.04.135 3 .405c2.295-1.56 3.3-1.23 3.3-1.23.66 1.65.24 2.88.12 3.18.765.84 1.23 1.905 1.23 3.225 0 4.605-2.805 5.625-5.475 5.925.435.375.81 1.095.81 2.22 0 1.605-.015 2.895-.015 3.3 0 .315.225.69.825.57A12.02 12.02 0 0024 12c0-6.63-5.37-12-12-12z"/>
          </svg>
        </div>
        <div class="github-text">
          <span class="github-label">solomonneas/watchtower-noc</span>
          <span class="github-desc">59 commits, TypeScript 52% / Python 43%</span>
        </div>
      </div>
      <div class="github-actions">
        <a href="https://watchtower.solomonneas.dev" target="_blank" rel="noopener" class="github-btn">
          <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg>
          Live Demo
        </a>
        <a href="https://github.com/solomonneas/watchtower-noc" target="_blank" rel="noopener" class="github-btn">
          <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0020 4.77 5.07 5.07 0 0019.91 1S18.73.65 16 2.48a13.38 13.38 0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 005 4.77a5.44 5.44 0 00-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 009 18.13V22"/></svg>
          View Repository
        </a>
        <span class="github-btn" style="cursor: default;">
          <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
          59 Commits
        </span>
        <a href="https://github.com/solomonneas/watchtower-noc/stargazers" target="_blank" rel="noopener" class="github-btn">
          <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>
          Star
        </a>
      </div>
    </div>
  </section>

  <!-- The Numbers: Cost Avoidance -->
  <section>
    <h2>The Numbers: Cost Avoidance</h2>
    <div class="cost-comparison">
      <div class="cost-card commercial">
        <div class="cost-header">
          <span class="cost-label">SolarWinds NPM</span>
          <span class="cost-badge">Commercial</span>
        </div>
        <div class="cost-body">
          <div class="cost-row">
            <span>SLA 100 License</span>
            <span class="cost-value">$2,877/yr</span>
          </div>
          <div class="cost-row">
            <span>NTA Module</span>
            <span class="cost-value">$1,915/yr</span>
          </div>
          <div class="cost-row">
            <span>NCM Module</span>
            <span class="cost-value">$1,687/yr</span>
          </div>
          <div class="cost-row">
            <span>SAM Module</span>
            <span class="cost-value">$2,644/yr</span>
          </div>
          <div class="cost-row total">
            <span>Annual Total</span>
            <span class="cost-value">$9,123/yr</span>
          </div>
        </div>
      </div>

      <div class="cost-arrow">
        <div class="arrow-line"></div>
        <div class="arrow-savings">$9,123 saved/yr</div>
        <div class="arrow-line"></div>
      </div>

      <div class="cost-card watchtower">
        <div class="cost-header">
          <span class="cost-label">Watchtower</span>
          <span class="cost-badge open">Open Source</span>
        </div>
        <div class="cost-body">
          <div class="cost-row">
            <span>LibreNMS</span>
            <span class="cost-value free">$0</span>
          </div>
          <div class="cost-row">
            <span>Netdisco</span>
            <span class="cost-value free">$0</span>
          </div>
          <div class="cost-row">
            <span>Redis + FastAPI</span>
            <span class="cost-value free">$0</span>
          </div>
          <div class="cost-row">
            <span>Development Time</span>
            <span class="cost-value free">Student Project</span>
          </div>
          <div class="cost-row total">
            <span>Annual Total</span>
            <span class="cost-value free">$0/yr</span>
          </div>
        </div>
      </div>
    </div>

    <div class="savings-highlight">
      <span class="savings-amount">$9,123</span>
      <span class="savings-label">annual cost avoidance vs. SolarWinds equivalent stack</span>
    </div>

    <div class="value-context">
      <div class="context-item">
        <span class="context-icon">üè´</span>
        <div class="context-text">
          <strong>State College Spending</strong>
          <span>Florida state colleges operate under tight IT budgets. Polk State's total IT spend serves 20,000+ students across multiple campuses. See <a href="https://www.polk.edu/about/budget/" target="_blank" rel="noopener">Polk State Budget</a>.</span>
        </div>
      </div>
      <div class="context-item">
        <span class="context-icon">üìä</span>
        <div class="context-text">
          <strong>Market Context</strong>
          <span>SolarWinds NPM starts at $2,877/yr for just 100 nodes. Full-stack monitoring (NPM + NTA + NCM + SAM) runs $9,123+/yr. See <a href="https://www.solarwinds.com/network-performance-monitor/pricing" target="_blank" rel="noopener">SolarWinds Pricing</a> and <a href="https://www.gartner.com/reviews/market/network-monitoring" target="_blank" rel="noopener">Gartner NMS Reviews</a>.</span>
        </div>
      </div>
    </div>

    <div class="cost-sources">
      <p>Sources: <a href="https://www.solarwinds.com/network-performance-monitor/pricing" target="_blank" rel="noopener">SolarWinds NPM Pricing</a>, <a href="https://www.solarwinds.com/netflow-traffic-analyzer/pricing" target="_blank" rel="noopener">NTA Pricing</a>, <a href="https://www.solarwinds.com/network-configuration-manager/pricing" target="_blank" rel="noopener">NCM Pricing</a>, <a href="https://www.solarwinds.com/server-application-monitor/pricing" target="_blank" rel="noopener">SAM Pricing</a>. Prices as of January 2026, SLA 100 tier.</p>
    </div>
  </section>

  <!-- Architecture -->
  <section>
    <h2>Architecture</h2>
    <div class="architecture">

      <!-- Data Sources Layer -->
      <div class="arch-layer">
        <div class="layer-label">Data Sources</div>
        <div class="source-grid">
          {dataSources.map((src) => (
            <div class="source-card" style={`border-color: ${src.color}`}>
              <div class="source-name" style={`color: ${src.color}`}>{src.name}</div>
              <div class="source-type">{src.type}</div>
              <div class="source-provides">{src.provides}</div>
            </div>
          ))}
        </div>
      </div>

      <!-- Connector -->
      <div class="arch-connector">
        <div class="connector-arrows">&#x25BC; &#x25BC; &#x25BC; &#x25BC;</div>
        <div class="connector-label">REST APIs + SNMP Polling</div>
      </div>

      <!-- Backend Layer -->
      <div class="arch-layer">
        <div class="layer-label">Backend (Python)</div>
        <div class="backend-flow">
          <div class="backend-box scheduler">
            <div class="box-title">APScheduler</div>
            <div class="box-desc">Timed polling jobs per data source</div>
          </div>
          <div class="flow-arrow">&#x25B6;</div>
          <div class="backend-box aggregator">
            <div class="box-title">Aggregator</div>
            <div class="box-desc">Normalize + merge multi-source data</div>
          </div>
          <div class="flow-arrow">&#x25B6;</div>
          <div class="backend-box cache">
            <div class="box-title">Redis</div>
            <div class="box-desc">In-memory topology + metrics cache</div>
          </div>
          <div class="flow-arrow">&#x25B6;</div>
          <div class="backend-box api">
            <div class="box-title">FastAPI</div>
            <div class="box-desc">REST endpoints + WebSocket server</div>
          </div>
        </div>
      </div>

      <!-- Connector -->
      <div class="arch-connector">
        <div class="connector-arrows">&#x25BC; WebSocket &#x25BC;</div>
        <div class="connector-label">Real-time push + REST fallback</div>
      </div>

      <!-- Frontend Layer -->
      <div class="arch-layer">
        <div class="layer-label">Frontend (React + TypeScript)</div>
        <div class="frontend-grid">
          <div class="frontend-box">
            <div class="box-title">TopologyCanvas</div>
            <div class="box-features">ReactFlow, drag/zoom, clusters, L2/L3 toggle</div>
          </div>
          <div class="frontend-box">
            <div class="box-title">Sidebar Widgets</div>
            <div class="box-features">Port grid, speedtest, port groups, Proxmox panel</div>
          </div>
          <div class="frontend-box">
            <div class="box-title">Zustand Store</div>
            <div class="box-features">Global state, WebSocket sync, optimistic updates</div>
          </div>
        </div>
      </div>

    </div>
  </section>

  <!-- Features -->
  <section>
    <h2>Features</h2>
    <div class="features-grid">
      {features.map((f) => (
        <div class="feature-card">
          <div class="feature-header">
            <span class="feature-icon">{f.icon}</span>
            <span class="feature-name">{f.name}</span>
          </div>
          <p class="feature-desc">{f.desc}</p>
          <span class="feature-tech">{f.tech}</span>
        </div>
      ))}
    </div>
  </section>

  <!-- Data Flow Example -->
  <section>
    <h2>Data Flow Example</h2>
    <p class="section-intro">When a switch goes offline, here is what happens end-to-end:</p>
    <div class="dataflow">
      <div class="flow-step">
        <div class="step-num">1</div>
        <div class="step-content">
          <div class="step-title">Detection</div>
          <div class="step-desc">APScheduler polls LibreNMS API. Device status changed from "up" to "down".</div>
        </div>
      </div>
      <div class="flow-connector"><div class="connector-pulse"></div></div>

      <div class="flow-step">
        <div class="step-num">2</div>
        <div class="step-content">
          <div class="step-title">Aggregation</div>
          <div class="step-desc">Aggregator merges new status with existing topology. Marks device and its links as degraded.</div>
        </div>
      </div>
      <div class="flow-connector"><div class="connector-pulse"></div></div>

      <div class="flow-step">
        <div class="step-num">3</div>
        <div class="step-content">
          <div class="step-title">Cache Update</div>
          <div class="step-desc">Updated topology written to Redis. Old cache invalidated atomically.</div>
        </div>
      </div>
      <div class="flow-connector"><div class="connector-pulse"></div></div>

      <div class="flow-step">
        <div class="step-num">4</div>
        <div class="step-content">
          <div class="step-title">Broadcast</div>
          <div class="step-desc">FastAPI WebSocket pushes topology_update message to all connected clients.</div>
        </div>
      </div>
      <div class="flow-connector"><div class="connector-pulse"></div></div>

      <div class="flow-step">
        <div class="step-num">5</div>
        <div class="step-content">
          <div class="step-title">State Update</div>
          <div class="step-desc">Zustand store receives WebSocket message, updates device and edge state immutably.</div>
        </div>
      </div>
      <div class="flow-connector"><div class="connector-pulse"></div></div>

      <div class="flow-step">
        <div class="step-num">6</div>
        <div class="step-content">
          <div class="step-title">Re-render</div>
          <div class="step-desc">ReactFlow re-renders affected node (red border) and edges (dashed/gray). Alert appears in sidebar.</div>
        </div>
      </div>
    </div>
  </section>

  <!-- Key Technical Decisions -->
  <section>
    <h2>Key Technical Decisions</h2>
    <div class="decisions-grid">
      {techDecisions.map((td) => (
        <div class="decision-card">
          <div class="decision-title">{td.decision}</div>
          <div class="decision-reason">{td.reason}</div>
        </div>
      ))}
    </div>
  </section>

  <!-- API Surface -->
  <section>
    <h2>API Surface</h2>
    <div class="api-section">
      <div class="api-group">
        <div class="api-label">REST Endpoints</div>
        <ul class="api-list">
          <li><code>GET /api/topology</code> - Full topology (nodes + edges)</li>
          <li><code>GET /api/devices</code> - All monitored devices with status</li>
          <li><code>GET /api/devices/{'{id}'}/ports</code> - Port details for a device</li>
          <li><code>GET /api/speedtest</code> - Latest speedtest results</li>
          <li><code>GET /api/speedtest/history</code> - Historical speedtest CSV</li>
          <li><code>GET /api/proxmox/nodes</code> - Proxmox cluster overview</li>
          <li><code>GET /api/proxmox/nodes/{'{node}'}</code> - VMs and containers for a node</li>
          <li><code>GET /api/port-groups</code> - Configured port group aggregations</li>
          <li><code>GET /api/alerts</code> - Active alerts</li>
          <li><code>POST /api/alerts/{'{id}'}/ack</code> - Acknowledge an alert</li>
          <li><code>GET /api/mermaid</code> - Topology as Mermaid diagram</li>
          <li><code>POST /api/auth/login</code> - Authenticate and receive JWT</li>
          <li><code>POST /api/auth/logout</code> - Invalidate session</li>
          <li><code>GET /api/settings</code> - Current configuration</li>
          <li><code>PUT /api/settings</code> - Update configuration</li>
        </ul>
      </div>
      <div class="api-group">
        <div class="api-label">WebSocket</div>
        <ul class="api-list">
          <li><code>WS /ws</code> - Real-time topology updates, device status changes, alerts</li>
        </ul>
        <p class="api-note">WebSocket messages use JSON with a <code>type</code> field: <code>topology_update</code>, <code>device_status</code>, <code>speedtest_result</code>, <code>alert</code>.</p>
      </div>
    </div>
  </section>

  <!-- Development Roadmap -->
  <section>
    <h2>Development Roadmap</h2>
    <div class="phases-grid">
      {phases.map((p) => (
        <div class={`phase-card ${p.status}`}>
          <div class="phase-header">
            <span class="phase-num">Phase {p.phase}</span>
            <span class="phase-status">{p.status === "completed" ? "‚úì" : "‚óã"}</span>
          </div>
          <div class="phase-name">{p.name}</div>
          <ul class="phase-items">
            {p.items.map((item) => (
              <li>{item}</li>
            ))}
          </ul>
        </div>
      ))}
    </div>
  </section>

  <!-- Current Status -->
  <section>
    <h2>Current Status</h2>
    <div class="status-block">
      <div class="status-indicator ongoing">
        <span class="status-pulse"></span>
        In Progress
      </div>
      <ul class="status-list">
        <li class="check">FastAPI backend with Redis caching</li>
        <li class="check">React frontend with ReactFlow topology</li>
        <li class="check">LibreNMS + Netdisco + Proxmox integrations</li>
        <li class="check">WebSocket real-time updates</li>
        <li class="check">CDP/LLDP auto-discovery</li>
        <li class="check">L2/L3 topology view toggle</li>
        <li class="check">Cisco-style port grid visualization</li>
        <li class="check">Speedtest widget with CSV export</li>
        <li class="check">Port group traffic monitoring</li>
        <li class="check">Mermaid diagram export</li>
        <li class="check">JWT authentication and user sessions</li>
        <li class="check">Settings UI with config editor</li>
        <li class="check">Historical data with InfluxDB</li>
        <li class="pending">Remote notifications (Discord, email)</li>
        <li class="pending">Role-based access control</li>
      </ul>
    </div>
  </section>

</ProjectLayout>

<style>
  /* ========== Animations ========== */
  @keyframes fadeSlideIn {
    from { opacity: 0; transform: translateY(12px); }
    to { opacity: 1; transform: translateY(0); }
  }

  @keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.4; }
  }

  /* ========== General ========== */
  .section-intro {
    color: color-mix(in srgb, var(--text-primary, #e2e8f0) 80%, transparent);
    line-height: 1.7;
    margin-bottom: 1.5rem;
    font-size: 1.05rem;
  }

  section {
    animation: fadeSlideIn 0.4s ease-out both;
  }

  /* ========== GitHub Callout ========== */
  .github-callout {
    display: flex;
    align-items: center;
    justify-content: space-between;
    flex-wrap: wrap;
    gap: 1rem;
    padding: 1.25rem 1.5rem;
    border-radius: 12px;
    background: color-mix(in srgb, #10b981 8%, var(--bg-secondary, #1e293b));
    border: 1px solid color-mix(in srgb, #10b981 25%, transparent);
  }

  .github-content {
    display: flex;
    align-items: center;
    gap: 1rem;
  }

  .github-icon {
    color: #10b981;
    flex-shrink: 0;
  }

  .github-text {
    display: flex;
    flex-direction: column;
    gap: 0.2rem;
  }

  .github-label {
    font-family: 'IBM Plex Mono', monospace;
    font-weight: 600;
    font-size: 1rem;
    color: var(--text-primary, #e2e8f0);
  }

  .github-desc {
    font-size: 0.85rem;
    color: color-mix(in srgb, var(--text-primary, #e2e8f0) 60%, transparent);
  }

  .github-actions {
    display: flex;
    gap: 0.5rem;
    flex-wrap: wrap;
  }

  .github-btn {
    display: inline-flex;
    align-items: center;
    gap: 0.4rem;
    padding: 0.45rem 0.85rem;
    border-radius: 8px;
    font-size: 0.82rem;
    font-weight: 500;
    text-decoration: none;
    color: var(--text-primary, #e2e8f0);
    background: color-mix(in srgb, var(--text-primary, #e2e8f0) 8%, transparent);
    border: 1px solid color-mix(in srgb, var(--text-primary, #e2e8f0) 15%, transparent);
    transition: all 0.2s ease;
  }

  .github-btn:hover {
    background: color-mix(in srgb, #10b981 15%, transparent);
    border-color: color-mix(in srgb, #10b981 40%, transparent);
  }

  /* ========== Cost Comparison ========== */
  .cost-comparison {
    display: flex;
    align-items: stretch;
    gap: 1.5rem;
    margin: 1.5rem 0;
  }

  .cost-card {
    flex: 1;
    border-radius: 12px;
    overflow: hidden;
    border: 1px solid color-mix(in srgb, var(--text-primary, #e2e8f0) 12%, transparent);
    background: color-mix(in srgb, var(--text-primary, #e2e8f0) 3%, var(--bg-secondary, #1e293b));
  }

  .cost-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0.85rem 1.15rem;
    border-bottom: 1px solid color-mix(in srgb, var(--text-primary, #e2e8f0) 10%, transparent);
  }

  .cost-label {
    font-family: 'IBM Plex Mono', monospace;
    font-weight: 600;
    font-size: 0.95rem;
  }

  .cost-badge {
    font-size: 0.7rem;
    padding: 0.2rem 0.55rem;
    border-radius: 20px;
    background: color-mix(in srgb, #ef4444 15%, transparent);
    color: #f87171;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.05em;
  }

  .cost-badge.open {
    background: color-mix(in srgb, #10b981 15%, transparent);
    color: #34d399;
  }

  .cost-body {
    padding: 0.85rem 1.15rem;
  }

  .cost-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0.45rem 0;
    font-size: 0.88rem;
    color: color-mix(in srgb, var(--text-primary, #e2e8f0) 75%, transparent);
  }

  .cost-row.total {
    border-top: 1px solid color-mix(in srgb, var(--text-primary, #e2e8f0) 15%, transparent);
    margin-top: 0.5rem;
    padding-top: 0.75rem;
    font-weight: 700;
    color: var(--text-primary, #e2e8f0);
  }

  .cost-value {
    font-family: 'IBM Plex Mono', monospace;
    font-weight: 600;
    color: #f87171;
  }

  .cost-value.free {
    color: #34d399;
  }

  .cost-arrow {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    min-width: 120px;
  }

  .arrow-line {
    width: 2px;
    height: 30px;
    background: color-mix(in srgb, #10b981 40%, transparent);
  }

  .arrow-savings {
    font-family: 'IBM Plex Mono', monospace;
    font-size: 0.85rem;
    font-weight: 700;
    color: #34d399;
    white-space: nowrap;
    padding: 0.3rem 0.75rem;
    border-radius: 20px;
    background: color-mix(in srgb, #10b981 12%, transparent);
    border: 1px solid color-mix(in srgb, #10b981 30%, transparent);
  }

  .savings-highlight {
    text-align: center;
    padding: 1.5rem;
    margin: 1.5rem 0;
    border-radius: 12px;
    background: color-mix(in srgb, #10b981 6%, transparent);
    border: 1px solid color-mix(in srgb, #10b981 20%, transparent);
  }

  .savings-amount {
    display: block;
    font-family: 'IBM Plex Mono', monospace;
    font-size: 2.5rem;
    font-weight: 800;
    color: #10b981;
    line-height: 1.2;
  }

  .savings-label {
    display: block;
    margin-top: 0.4rem;
    font-size: 0.9rem;
    color: color-mix(in srgb, var(--text-primary, #e2e8f0) 65%, transparent);
  }

  .value-context {
    display: flex;
    flex-direction: column;
    gap: 1rem;
    margin: 1.5rem 0;
  }

  .context-item {
    display: flex;
    gap: 1rem;
    align-items: flex-start;
    padding: 1rem;
    border-radius: 10px;
    background: color-mix(in srgb, var(--text-primary, #e2e8f0) 3%, transparent);
    border: 1px solid color-mix(in srgb, var(--text-primary, #e2e8f0) 8%, transparent);
  }

  .context-icon {
    font-size: 1.5rem;
    flex-shrink: 0;
  }

  .context-text {
    display: flex;
    flex-direction: column;
    gap: 0.25rem;
    font-size: 0.88rem;
    line-height: 1.6;
    color: color-mix(in srgb, var(--text-primary, #e2e8f0) 75%, transparent);
  }

  .context-text strong {
    color: var(--text-primary, #e2e8f0);
  }

  .context-text a {
    color: #10b981;
    text-decoration: underline;
    text-underline-offset: 2px;
  }

  .cost-sources {
    font-size: 0.78rem;
    color: color-mix(in srgb, var(--text-primary, #e2e8f0) 45%, transparent);
    margin-top: 1rem;
    line-height: 1.6;
  }

  .cost-sources a {
    color: color-mix(in srgb, #10b981 70%, var(--text-primary, #e2e8f0));
    text-decoration: underline;
    text-underline-offset: 2px;
  }

  /* ========== Architecture ========== */
  .architecture {
    display: flex;
    flex-direction: column;
    gap: 0;
    margin: 1.5rem 0;
  }

  .arch-layer {
    padding: 1.25rem;
    border-radius: 12px;
    background: color-mix(in srgb, var(--text-primary, #e2e8f0) 3%, var(--bg-secondary, #1e293b));
    border: 1px solid color-mix(in srgb, var(--text-primary, #e2e8f0) 10%, transparent);
  }

  .layer-label {
    font-family: 'IBM Plex Mono', monospace;
    font-size: 0.75rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.1em;
    color: #10b981;
    margin-bottom: 1rem;
  }

  .source-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 0.75rem;
  }

  .source-card {
    padding: 0.85rem;
    border-radius: 8px;
    border-left: 3px solid;
    background: color-mix(in srgb, var(--text-primary, #e2e8f0) 4%, transparent);
  }

  .source-name {
    font-family: 'IBM Plex Mono', monospace;
    font-weight: 700;
    font-size: 0.9rem;
    margin-bottom: 0.2rem;
  }

  .source-type {
    font-size: 0.75rem;
    color: color-mix(in srgb, var(--text-primary, #e2e8f0) 55%, transparent);
    margin-bottom: 0.35rem;
    font-family: 'IBM Plex Mono', monospace;
  }

  .source-provides {
    font-size: 0.82rem;
    line-height: 1.4;
    color: color-mix(in srgb, var(--text-primary, #e2e8f0) 70%, transparent);
  }

  .arch-connector {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 0.75rem 0;
    gap: 0.25rem;
  }

  .connector-arrows {
    font-size: 0.9rem;
    letter-spacing: 1.5rem;
    color: #10b981;
    opacity: 0.7;
  }

  .connector-label {
    font-family: 'IBM Plex Mono', monospace;
    font-size: 0.72rem;
    color: color-mix(in srgb, var(--text-primary, #e2e8f0) 50%, transparent);
  }

  .backend-flow {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    overflow-x: auto;
    padding-bottom: 0.25rem;
  }

  .backend-box {
    flex: 1;
    min-width: 140px;
    padding: 0.85rem;
    border-radius: 8px;
    background: color-mix(in srgb, var(--text-primary, #e2e8f0) 5%, transparent);
    border: 1px solid color-mix(in srgb, var(--text-primary, #e2e8f0) 12%, transparent);
    text-align: center;
  }

  .backend-box .box-title,
  .frontend-box .box-title {
    font-family: 'IBM Plex Mono', monospace;
    font-weight: 700;
    font-size: 0.88rem;
    color: var(--text-primary, #e2e8f0);
    margin-bottom: 0.3rem;
  }

  .backend-box .box-desc {
    font-size: 0.78rem;
    color: color-mix(in srgb, var(--text-primary, #e2e8f0) 60%, transparent);
    line-height: 1.4;
  }

  .flow-arrow {
    color: #10b981;
    font-size: 1.1rem;
    flex-shrink: 0;
    opacity: 0.7;
  }

  .frontend-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 0.75rem;
  }

  .frontend-box {
    padding: 0.85rem;
    border-radius: 8px;
    background: color-mix(in srgb, var(--text-primary, #e2e8f0) 5%, transparent);
    border: 1px solid color-mix(in srgb, var(--text-primary, #e2e8f0) 12%, transparent);
  }

  .box-features {
    font-size: 0.78rem;
    color: color-mix(in srgb, var(--text-primary, #e2e8f0) 60%, transparent);
    line-height: 1.4;
  }

  /* ========== Features ========== */
  .features-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 1rem;
    margin: 1.5rem 0;
  }

  .feature-card {
    padding: 1.15rem;
    border-radius: 10px;
    background: color-mix(in srgb, var(--text-primary, #e2e8f0) 3%, var(--bg-secondary, #1e293b));
    border: 1px solid color-mix(in srgb, var(--text-primary, #e2e8f0) 10%, transparent);
    transition: border-color 0.2s ease, transform 0.2s ease;
  }

  .feature-card:hover {
    border-color: color-mix(in srgb, #10b981 35%, transparent);
    transform: translateY(-2px);
  }

  .feature-header {
    display: flex;
    align-items: center;
    gap: 0.6rem;
    margin-bottom: 0.6rem;
  }

  .feature-icon {
    font-size: 1.3rem;
  }

  .feature-name {
    font-weight: 700;
    font-size: 0.95rem;
    color: var(--text-primary, #e2e8f0);
  }

  .feature-desc {
    font-size: 0.85rem;
    line-height: 1.55;
    color: color-mix(in srgb, var(--text-primary, #e2e8f0) 70%, transparent);
    margin-bottom: 0.65rem;
  }

  .feature-tech {
    display: inline-block;
    font-family: 'IBM Plex Mono', monospace;
    font-size: 0.72rem;
    padding: 0.25rem 0.6rem;
    border-radius: 6px;
    background: color-mix(in srgb, #10b981 10%, transparent);
    color: #34d399;
    border: 1px solid color-mix(in srgb, #10b981 20%, transparent);
  }

  /* ========== Data Flow ========== */
  .dataflow {
    margin: 1.5rem 0;
  }

  .flow-step {
    display: flex;
    gap: 1rem;
    align-items: flex-start;
    padding: 1rem;
    border-radius: 10px;
    background: color-mix(in srgb, var(--text-primary, #e2e8f0) 3%, var(--bg-secondary, #1e293b));
    border: 1px solid color-mix(in srgb, var(--text-primary, #e2e8f0) 10%, transparent);
  }

  .step-num {
    width: 36px;
    height: 36px;
    border-radius: 50%;
    background: color-mix(in srgb, #10b981 15%, transparent);
    color: #10b981;
    display: flex;
    align-items: center;
    justify-content: center;
    font-family: 'IBM Plex Mono', monospace;
    font-weight: 800;
    font-size: 0.9rem;
    flex-shrink: 0;
    border: 1px solid color-mix(in srgb, #10b981 30%, transparent);
  }

  .step-content {
    flex: 1;
  }

  .step-title {
    font-weight: 700;
    font-size: 0.95rem;
    color: var(--text-primary, #e2e8f0);
    margin-bottom: 0.25rem;
  }

  .step-desc {
    font-size: 0.85rem;
    line-height: 1.5;
    color: color-mix(in srgb, var(--text-primary, #e2e8f0) 70%, transparent);
  }

  .flow-connector {
    display: flex;
    justify-content: center;
    padding: 0.35rem 0;
  }

  .connector-pulse {
    width: 2px;
    height: 20px;
    background: color-mix(in srgb, #10b981 40%, transparent);
    border-radius: 1px;
    animation: pulse 2s ease-in-out infinite;
  }

  /* ========== Decisions ========== */
  .decisions-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 0.85rem;
    margin: 1.5rem 0;
  }

  .decision-card {
    padding: 1rem;
    border-radius: 10px;
    background: color-mix(in srgb, var(--text-primary, #e2e8f0) 3%, var(--bg-secondary, #1e293b));
    border: 1px solid color-mix(in srgb, var(--text-primary, #e2e8f0) 10%, transparent);
  }

  .decision-title {
    font-family: 'IBM Plex Mono', monospace;
    font-weight: 700;
    font-size: 0.9rem;
    color: #10b981;
    margin-bottom: 0.35rem;
  }

  .decision-reason {
    font-size: 0.85rem;
    line-height: 1.5;
    color: color-mix(in srgb, var(--text-primary, #e2e8f0) 70%, transparent);
  }

  /* ========== API Surface ========== */
  .api-section {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
    margin: 1.5rem 0;
  }

  .api-group {
    padding: 1.15rem;
    border-radius: 10px;
    background: color-mix(in srgb, var(--text-primary, #e2e8f0) 3%, var(--bg-secondary, #1e293b));
    border: 1px solid color-mix(in srgb, var(--text-primary, #e2e8f0) 10%, transparent);
  }

  .api-label {
    font-family: 'IBM Plex Mono', monospace;
    font-weight: 700;
    font-size: 0.85rem;
    color: #10b981;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    margin-bottom: 0.75rem;
  }

  .api-list {
    list-style: none;
    padding: 0;
    margin: 0;
    display: flex;
    flex-direction: column;
    gap: 0.4rem;
  }

  .api-list li {
    font-size: 0.85rem;
    color: color-mix(in srgb, var(--text-primary, #e2e8f0) 75%, transparent);
    line-height: 1.5;
  }

  .api-list code {
    font-family: 'IBM Plex Mono', monospace;
    font-size: 0.82rem;
    padding: 0.15rem 0.45rem;
    border-radius: 4px;
    background: color-mix(in srgb, #10b981 8%, transparent);
    color: #34d399;
    border: 1px solid color-mix(in srgb, #10b981 15%, transparent);
  }

  .api-note {
    margin-top: 0.75rem;
    font-size: 0.82rem;
    color: color-mix(in srgb, var(--text-primary, #e2e8f0) 55%, transparent);
    line-height: 1.5;
  }

  .api-note code {
    font-family: 'IBM Plex Mono', monospace;
    font-size: 0.78rem;
    padding: 0.1rem 0.35rem;
    border-radius: 3px;
    background: color-mix(in srgb, var(--text-primary, #e2e8f0) 8%, transparent);
    color: color-mix(in srgb, var(--text-primary, #e2e8f0) 80%, transparent);
  }

  /* ========== Phases ========== */
  .phases-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
    gap: 0.85rem;
    margin: 1.5rem 0;
  }

  .phase-card {
    padding: 1rem;
    border-radius: 10px;
    background: color-mix(in srgb, var(--text-primary, #e2e8f0) 3%, var(--bg-secondary, #1e293b));
    border: 1px solid color-mix(in srgb, var(--text-primary, #e2e8f0) 10%, transparent);
  }

  .phase-card.completed {
    border-color: color-mix(in srgb, #10b981 25%, transparent);
  }

  .phase-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 0.5rem;
  }

  .phase-num {
    font-family: 'IBM Plex Mono', monospace;
    font-size: 0.72rem;
    font-weight: 700;
    color: color-mix(in srgb, var(--text-primary, #e2e8f0) 50%, transparent);
    text-transform: uppercase;
    letter-spacing: 0.05em;
  }

  .phase-status {
    font-size: 1rem;
  }

  .phase-card.completed .phase-status {
    color: #10b981;
  }

  .phase-card.pending .phase-status {
    color: color-mix(in srgb, var(--text-primary, #e2e8f0) 35%, transparent);
  }

  .phase-name {
    font-weight: 700;
    font-size: 0.95rem;
    color: var(--text-primary, #e2e8f0);
    margin-bottom: 0.5rem;
  }

  .phase-items {
    list-style: none;
    padding: 0;
    margin: 0;
    display: flex;
    flex-direction: column;
    gap: 0.2rem;
  }

  .phase-items li {
    font-size: 0.8rem;
    color: color-mix(in srgb, var(--text-primary, #e2e8f0) 60%, transparent);
    padding-left: 0.75rem;
    position: relative;
  }

  .phase-items li::before {
    content: "¬∑";
    position: absolute;
    left: 0;
    color: color-mix(in srgb, var(--text-primary, #e2e8f0) 35%, transparent);
  }

  /* ========== Status ========== */
  .status-block {
    padding: 1.5rem;
    border-radius: 12px;
    background: color-mix(in srgb, var(--text-primary, #e2e8f0) 3%, var(--bg-secondary, #1e293b));
    border: 1px solid color-mix(in srgb, var(--text-primary, #e2e8f0) 10%, transparent);
    margin: 1.5rem 0;
  }

  .status-indicator {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    font-family: 'IBM Plex Mono', monospace;
    font-weight: 700;
    font-size: 0.9rem;
    margin-bottom: 1rem;
    padding: 0.4rem 0.85rem;
    border-radius: 20px;
    background: color-mix(in srgb, #f59e0b 12%, transparent);
    color: #fbbf24;
    border: 1px solid color-mix(in srgb, #f59e0b 25%, transparent);
  }

  .status-pulse {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background: #f59e0b;
    animation: pulse 2s ease-in-out infinite;
  }

  .status-list {
    list-style: none;
    padding: 0;
    margin: 0;
    display: flex;
    flex-direction: column;
    gap: 0.4rem;
  }

  .status-list li {
    font-size: 0.88rem;
    line-height: 1.5;
    padding-left: 1.5rem;
    position: relative;
  }

  .status-list li.check {
    color: color-mix(in srgb, var(--text-primary, #e2e8f0) 80%, transparent);
  }

  .status-list li.check::before {
    content: "‚úì";
    position: absolute;
    left: 0;
    color: #10b981;
    font-weight: 700;
  }

  .status-list li.pending {
    color: color-mix(in srgb, var(--text-primary, #e2e8f0) 50%, transparent);
  }

  .status-list li.pending::before {
    content: "‚óã";
    position: absolute;
    left: 0;
    color: color-mix(in srgb, var(--text-primary, #e2e8f0) 35%, transparent);
  }

  /* ========== Responsive ========== */
  @media (max-width: 768px) {
    .cost-comparison {
      flex-direction: column;
    }

    .cost-arrow {
      flex-direction: row;
      min-width: unset;
      padding: 0.5rem 0;
    }

    .arrow-line {
      width: 30px;
      height: 2px;
    }

    .backend-flow {
      flex-direction: column;
    }

    .flow-arrow {
      transform: rotate(90deg);
    }

    .features-grid,
    .decisions-grid {
      grid-template-columns: 1fr;
    }

    .phases-grid {
      grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
    }

    .github-callout {
      flex-direction: column;
      align-items: flex-start;
    }

    .savings-amount {
      font-size: 2rem;
    }

    .source-grid,
    .frontend-grid {
      grid-template-columns: 1fr;
    }
  }

  @media (max-width: 480px) {
    .phases-grid {
      grid-template-columns: 1fr;
    }
  }
</style>
